<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>äºŒå¹´çº§æ•°å­¦ Â· ä¸–ç•ŒäºŒï¼šç™¾æ•°ç‹å›½</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
      background: radial-gradient(circle at top, #0f172a, #020617 60%);
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px 10px 40px;
    }
    .container {
      width: 100%;
      max-width: 1100px;
    }
    a.back {
      display: inline-block;
      margin-bottom: 8px;
      font-size: 13px;
      color: #38bdf8;
      text-decoration: none;
    }
    a.back:hover { text-decoration: underline; }

    h1 {
      margin: 4px 0 4px;
      font-size: 24px;
    }
    .subtitle {
      font-size: 14px;
      color: #9ca3af;
      margin-bottom: 16px;
    }

    .card {
      background: rgba(15,23,42,0.96);
      border-radius: 18px;
      padding: 18px;
      box-shadow: 0 16px 40px rgba(15,23,42,0.9);
      border: 1px solid #1f2937;
    }

    .mode-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 14px;
    }
    .mode-btn {
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 14px;
      border: 1px solid #374151;
      background: #020617;
      color: #e5e7eb;
      cursor: pointer;
      transition: all .15s ease;
      white-space: nowrap;
    }
    .mode-btn:hover {
      background: #0b1120;
      border-color: #38bdf8;
    }
    .mode-btn.active {
      background: #2563eb;
      border-color: #60a5fa;
      color: #e5f0ff;
    }

    .game-section { display: none; margin-top: 6px; }
    .game-section.active { display: block; }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
      font-size: 14px;
      color: #9ca3af;
    }

    .board {
      margin: 6px 0 12px;
      border-radius: 14px;
      border: 1px solid #1f2937;
      background: #020617;
      padding: 14px;
    }

    .prompt {
      font-size: 15px;
      margin-bottom: 8px;
    }

    .feedback {
      min-height: 20px;
      font-size: 14px;
      margin-top: 6px;
    }
    .feedback.ok { color: #4ade80; }
    .feedback.bad { color: #fca5a5; }

    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
      margin-top: 10px;
      flex-wrap: wrap;
    }
    .btn {
      border-radius: 999px;
      padding: 6px 16px;
      font-size: 14px;
      border: none;
      cursor: pointer;
      transition: all .15s ease;
    }
    .btn-main {
      background: #2563eb;
      color: #fff;
    }
    .btn-main:disabled {
      background: #1f2937;
      color: #6b7280;
      cursor: not-allowed;
    }
    .btn-ghost {
      background: transparent;
      border: 1px solid #4b5563;
      color: #9ca3af;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .num-grid {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 8px;
      margin-bottom: 6px;
    }
    .num-btn {
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      font-size: 16px;
      padding: 6px 0;
      cursor: pointer;
      transition: all .15s ease;
    }
    .num-btn:hover {
      background: #0b1120;
      border-color: #38bdf8;
    }
    .num-btn.correct {
      background: #16a34a;
      border-color: #22c55e;
      color: #e5fdf0;
    }
    .num-btn.wrong {
      background: #7f1d1d;
      border-color: #ef4444;
      color: #fee2e2;
    }

    /* ç©æ³•1ï¼šæ•°è½´ */
    .number-line {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 10px;
    }
    .nl-point {
      min-width: 26px;
      padding: 4px 2px;
      text-align: center;
      font-size: 13px;
      border-radius: 6px;
      border: 1px solid #1f2937;
      color: #e5e7eb;
      background: #020617;
    }
    .nl-tip {
      text-align: center;
      font-size: 14px;
      color: #93c5fd;
      margin-top: 8px;
    }

    /* ç©æ³•2ï¼šæ‹†å */
    .pile-label {
      font-size: 13px;
      color: #9ca3af;
      margin-bottom: 4px;
      text-align: center;
    }
    .pile-row {
      display: flex;
      flex-wrap: wrap;
      gap: 4px;
      justify-content: center;
      font-size: 22px;
      min-height: 28px;
    }

    /* ç©æ³•3ï¼šç™¾æ•°è¡¨ */
    .hundred-grid {
      display: grid;
      grid-template-columns: repeat(10, minmax(0,1fr));
      gap: 3px;
      max-height: 260px;
      overflow-y: auto;
      margin-top: 10px;
    }
    .hundred-cell {
      font-size: 11px;
      padding: 4px 0;
      text-align: center;
      border-radius: 6px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      cursor: pointer;
    }
    .hundred-cell.correct {
      background: #15803d;
      border-color: #22c55e;
    }
    .hundred-cell.wrong {
      background: #7f1d1d;
      border-color: #ef4444;
    }

    /* ç©æ³•4ï¼šå°å•†åº— */
    .shop-items {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .item-card {
      flex: 1;
      min-width: 120px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      padding: 8px;
      background: #020617;
      font-size: 13px;
    }
    .item-name { font-weight: bold; margin-bottom: 4px; }
    .item-price { color: #a5b4fc; }

    /* ç©æ³•5ï¼šä¹˜æ³•é˜µåˆ— */
    .array-grid {
      display: grid;
      gap: 4px;
      justify-content: center;
      margin-top: 8px;
    }
    .array-row {
      display: flex;
      gap: 4px;
      justify-content: center;
    }
    .array-cell {
      width: 26px;
      height: 26px;
      border-radius: 6px;
      border: 1px solid #1f2937;
      background: #020617;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 16px;
    }

    /* ç©æ³•6ï¼šé…å¯¹ */
    .pair-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap: 8px;
      margin-top: 10px;
    }
    .pair-card {
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      padding: 10px 4px;
      text-align: center;
      font-size: 14px;
      cursor: pointer;
      transition: all .15s ease;
      min-height: 36px;
    }
    .pair-card.active {
      background: #1d4ed8;
      border-color: #60a5fa;
    }
    .pair-card.matched {
      background: #16a34a;
      border-color: #22c55e;
      color: #e5fdf0;
      cursor: default;
    }

    @media (max-width: 640px) {
      .num-grid { grid-template-columns: repeat(3, minmax(0,1fr)); }
    }
  </style>
</head>
<body>
  <div class="container">
    <a href="math.html" class="back">âª è¿”å›æ•°å­¦å­¦ä¹ ä¸­å¿ƒ</a>

    <h1>äºŒå¹´çº§æ•°å­¦ Â· ä¸–ç•ŒäºŒï¼šç™¾æ•°ç‹å›½</h1>
    <div class="subtitle">
      æœ¬ä¸–ç•Œæœ‰ <b>6 ç§å°æ¸¸æˆ</b>ï¼šæ•°è½´è·³ä¸€è·³ã€æ‹†åå°å·¥åŠã€ç™¾æ•°è¡¨å¯»å®ã€å°å•†åº—ä¹°ä¸œè¥¿ã€ä¹˜æ³•é˜µåˆ—å†œåœºã€ä¹˜æ³•å£è¯€é…å¯¹ã€‚
      è¯·é€‰æ‹©ä¸€ç§ç©æ³•å¼€å§‹é—¯å…³å§ï¼
    </div>

    <div class="card">
      <div class="mode-bar">
        <button class="mode-btn active" data-mode="1">ç©æ³•ä¸€ï¼šæ•°è½´è·³ä¸€è·³</button>
        <button class="mode-btn" data-mode="2">ç©æ³•äºŒï¼šæ‹†åå°å·¥åŠ</button>
        <button class="mode-btn" data-mode="3">ç©æ³•ä¸‰ï¼šç™¾æ•°è¡¨å¯»å®</button>
        <button class="mode-btn" data-mode="4">ç©æ³•å››ï¼šå°å•†åº—ä¹°ä¸œè¥¿</button>
        <button class="mode-btn" data-mode="5">ç©æ³•äº”ï¼šä¹˜æ³•é˜µåˆ—å†œåœº</button>
        <button class="mode-btn" data-mode="6">ç©æ³•å…­ï¼šä¹˜æ³•å£è¯€é…å¯¹</button>
      </div>

      <!-- ç©æ³•ä¸€ï¼šæ•°è½´è·³ä¸€è·³ -->
      <section id="mode-1" class="game-section active">
        <div class="top-bar">
          <div>ç©æ³•ä¸€ï¼šç”¨æ•°è½´æ¥åš 20 ä»¥å†…åŠ æ³•</div>
          <div>å¾—åˆ†ï¼š<span id="m1-score">0</span></div>
        </div>
        <div class="board">
          <div class="prompt" id="m1-prompt">é¢˜ç›®ï¼š8 + 6 = ?</div>
          <div class="number-line" id="m1-line"></div>
          <div class="nl-tip" id="m1-tip">ä» 8 å¼€å§‹ï¼Œå‘å‰è·³ 6 æ ¼ï¼Œä¼šåˆ°å“ªé‡Œå‘¢ï¼Ÿ</div>
        </div>
        <div class="prompt">è¯·ç‚¹å‡»ä½ è®¤ä¸ºæ­£ç¡®çš„ç­”æ¡ˆï¼š</div>
        <div class="num-grid" id="m1-num-grid"></div>
        <div class="feedback" id="m1-feedback"></div>
        <div class="controls">
          <button class="btn btn-ghost" id="m1-restart">ğŸ” æ¢ä¸€é¢˜</button>
          <button class="btn btn-main" id="m1-next" disabled>ä¸‹ä¸€é¢˜ â–¶</button>
        </div>
      </section>

      <!-- ç©æ³•äºŒï¼šæ‹†åå°å·¥åŠï¼ˆä¸Šä¸‹ä¸¤å †ï¼‰ -->
      <section id="mode-2" class="game-section">
        <div class="top-bar">
          <div>ç©æ³•äºŒï¼šç”¨â€œå‡‘åâ€çš„æ–¹æ³•åšåŠ æ³•</div>
          <div>å¾—åˆ†ï¼š<span id="m2-score">0</span></div>
        </div>
        <div class="board">
          <div class="prompt" id="m2-prompt">é¢˜ç›®ï¼š9 + 6</div>
          <div style="display:flex; flex-direction:column; gap:16px; align-items:center; margin-top:10px;">
            <div>
              <div class="pile-label">ä¸Šé¢çš„ä¸€å †</div>
              <div id="m2-left" class="pile-row"></div>
            </div>
            <div style="font-size:26px; color:#38bdf8;">â¬‡ï¸</div>
            <div>
              <div class="pile-label">ä¸‹é¢çš„ä¸€å †</div>
              <div id="m2-right" class="pile-row"></div>
            </div>
          </div>
          <div style="font-size:13px; color:#cbd5f5; margin-top:10px;">
            æç¤ºï¼šæƒ³è±¡ä»ä¸‹é¢æ¬ä¸€äº›å°æ–¹å—åˆ°ä¸Šé¢ï¼Œè®©ä¸Šé¢â€œåˆšå¥½å˜æˆ 10â€ï¼Œå†çœ‹è¿˜å‰©å¤šå°‘ã€‚
          </div>
        </div>
        <div class="prompt">ä¸‹é¢å“ªä¸€å¥æ˜¯å¯¹è¿™é“é¢˜çš„æœ€å¥½è§£é‡Šï¼Ÿ</div>
        <div class="num-grid" id="m2-options"></div>
        <div class="feedback" id="m2-feedback"></div>
        <div class="controls">
          <button class="btn btn-ghost" id="m2-restart">ğŸ” æ¢ä¸€é¢˜</button>
          <button class="btn btn-main" id="m2-next" disabled>ä¸‹ä¸€é¢˜ â–¶</button>
        </div>
      </section>

      <!-- ç©æ³•ä¸‰ï¼šç™¾æ•°è¡¨å¯»å® -->
      <section id="mode-3" class="game-section">
        <div class="top-bar">
          <div>ç©æ³•ä¸‰ï¼šåœ¨ç™¾æ•°è¡¨ä¸Šæ‰¾æ•°å­—</div>
          <div>å¾—åˆ†ï¼š<span id="m3-score">0</span></div>
        </div>
        <div class="board">
          <div class="prompt" id="m3-prompt">è¯·åœ¨ä¸‹é¢çš„ç™¾æ•°è¡¨ä¸­æ‰¾åˆ° 37ï¼Œç‚¹å‡»å®ƒã€‚</div>
          <div class="hundred-grid" id="m3-grid"></div>
        </div>
        <div class="feedback" id="m3-feedback"></div>
        <div class="controls">
          <button class="btn btn-main" id="m3-next">æ¢ä¸€ä¸ªæ•°å­— â–¶</button>
        </div>
      </section>

      <!-- ç©æ³•å››ï¼šå°å•†åº—ä¹°ä¸œè¥¿ -->
      <section id="mode-4" class="game-section">
        <div class="top-bar">
          <div>ç©æ³•å››ï¼šç”¨åŠ å‡æ³•ä¹°ä¸œè¥¿</div>
          <div>å¾—åˆ†ï¼š<span id="m4-score">0</span></div>
        </div>
        <div class="board">
          <div class="prompt" id="m4-prompt">ä½ æœ‰ 50 å…ƒï¼Œä¹°ä¸€ä¸ª 32 å…ƒçš„ç©å…·è½¦ï¼Œè¿˜å‰©å¤šå°‘é’±ï¼Ÿ</div>
          <div class="shop-items" id="m4-items"></div>
        </div>
        <div class="prompt">è¯·é€‰æ‹©æ­£ç¡®çš„ç­”æ¡ˆï¼š</div>
        <div class="num-grid" id="m4-options"></div>
        <div class="feedback" id="m4-feedback"></div>
        <div class="controls">
          <button class="btn btn-ghost" id="m4-restart">ğŸ” å†æ¥ä¸€é¢˜</button>
          <button class="btn btn-main" id="m4-next" disabled>ä¸‹ä¸€é¢˜ â–¶</button>
        </div>
      </section>

      <!-- ç©æ³•äº”ï¼šä¹˜æ³•é˜µåˆ—å†œåœºï¼ˆä¸¤æ­¥ï¼šå…¬å¼ + ç»“æœï¼‰ -->
      <section id="mode-5" class="game-section">
        <div class="top-bar">
          <div>ç©æ³•äº”ï¼šå‡ è¡Œå‡ åˆ—æœ‰å¤šå°‘ä¸ªï¼Ÿ</div>
          <div>å¾—åˆ†ï¼š<span id="m5-score">0</span></div>
        </div>
        <div class="board">
          <div class="prompt" id="m5-prompt">
            è¿™é‡Œæœ‰ 3 è¡Œï¼Œæ¯è¡Œ 4 ä¸ªå°åŠ¨ç‰©ï¼Œä¸€å…±æœ‰å¤šå°‘ä¸ªï¼Ÿ
          </div>
          <div class="array-grid" id="m5-array"></div>
        </div>
        <div class="prompt" id="m5-step1-label">
          ç¬¬ä¸€æ­¥ï¼šä¸‹é¢å“ªä¸€å¥ç®—å¼ï¼Œæœ€ç¬¦åˆâ€œæœ‰å‡ è¡Œï¼Œæ¯è¡Œæœ‰å‡ ä¸ªâ€ï¼Ÿ
        </div>
        <div class="num-grid" id="m5-exp-options"></div>

        <div class="prompt" id="m5-step2-label" style="display:none;">
          ç¬¬äºŒæ­¥ï¼šä½ é€‰çš„è¿™ä¸ªç®—å¼ï¼Œç»“æœæ˜¯å¤šå°‘ï¼Ÿ
        </div>
        <div class="num-grid" id="m5-num-options" style="display:none;"></div>

        <div class="feedback" id="m5-feedback"></div>
        <div class="controls">
          <button class="btn btn-ghost" id="m5-restart">ğŸ” æ¢ä¸€é¢˜</button>
          <button class="btn btn-main" id="m5-next" disabled>ä¸‹ä¸€é¢˜ â–¶</button>
        </div>
      </section>

      <!-- ç©æ³•å…­ï¼šä¹˜æ³•å£è¯€é…å¯¹ -->
      <section id="mode-6" class="game-section">
        <div class="top-bar">
          <div>ç©æ³•å…­ï¼š2ï½5 çš„ä¹˜æ³•å£è¯€é…å¯¹</div>
          <div>å®Œæˆæ•°ï¼š<span id="m6-done">0</span>/4</div>
        </div>
        <div class="board">
          <div class="prompt">
            ç‚¹å‡»ä¸€å¼ â€œç®—å¼â€å¡ç‰‡ï¼Œå†ç‚¹å‡»ä¸€å¼ â€œç­”æ¡ˆâ€å¡ç‰‡ï¼Œé…å¯¹æˆåŠŸå°±ä¼šäº®èµ·æ¥ã€‚
          </div>
          <div class="pair-grid" id="m6-grid"></div>
        </div>
        <div class="feedback" id="m6-feedback"></div>
        <div class="controls">
          <button class="btn btn-ghost" id="m6-restart">ğŸ” é‡æ–°æ´—ç‰Œ</button>
        </div>
      </section>
    </div>
  </div>

  <script>
    // æ¨¡å¼åˆ‡æ¢
    const modeButtons = document.querySelectorAll(".mode-btn");
    const sections = document.querySelectorAll(".game-section");

    function switchMode(mode) {
      modeButtons.forEach(btn => {
        btn.classList.toggle("active", btn.dataset.mode === String(mode));
      });
      sections.forEach(sec => {
        sec.classList.toggle("active", sec.id === "mode-" + mode);
      });
    }
    modeButtons.forEach(btn => {
      btn.addEventListener("click", () => switchMode(btn.dataset.mode));
    });

    // å°å·¥å…·
    function shuffle(arr) {
      return arr.sort(() => Math.random() - 0.5);
    }

    /* ---------- ç©æ³•ä¸€ï¼šæ•°è½´è·³ä¸€è·³ ---------- */
    (function() {
      const scoreEl = document.getElementById("m1-score");
      const promptEl = document.getElementById("m1-prompt");
      const lineEl = document.getElementById("m1-line");
      const tipEl = document.getElementById("m1-tip");
      const numGridEl = document.getElementById("m1-num-grid");
      const feedbackEl = document.getElementById("m1-feedback");
      const nextBtn = document.getElementById("m1-next");
      const restartBtn = document.getElementById("m1-restart");

      let a = 8, b = 6, answer = 14;
      let score = 0;
      let answered = false;

      function buildAnswerButtons() {
        numGridEl.innerHTML = "";
        for (let i = 0; i <= 20; i++) {
          const btn = document.createElement("button");
          btn.className = "num-btn";
          btn.textContent = i;
          btn.addEventListener("click", () => handleAnswer(i, btn));
          numGridEl.appendChild(btn);
        }
      }

      function renderNumberLine() {
        lineEl.innerHTML = "";
        for (let i = 0; i <= 20; i++) {
          const div = document.createElement("div");
          div.className = "nl-point";
          div.textContent = i;
          lineEl.appendChild(div);
        }
        tipEl.textContent = `ä» ${a} å¼€å§‹ï¼Œå‘å‰è·³ ${b} æ ¼ï¼Œä¼šåˆ°å“ªä¸ªæ•°å­—å‘¢ï¼Ÿ`;
      }

      function newQuestion() {
        answered = false;
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";
        nextBtn.disabled = true;
        numGridEl.querySelectorAll(".num-btn").forEach(btn => {
          btn.disabled = false;
          btn.classList.remove("correct","wrong");
        });

        a = Math.floor(Math.random() * 16); // 0~15
        b = Math.floor(Math.random() * 9) + 1; // 1~9
        if (a + b > 20) a = 20 - b;
        answer = a + b;

        promptEl.textContent = `é¢˜ç›®ï¼š${a} + ${b} = ?`;
        renderNumberLine();
      }

      function handleAnswer(val, btn) {
        if (answered) return;
        answered = true;
        numGridEl.querySelectorAll(".num-btn").forEach(b => b.disabled = true);

        if (val === answer) {
          btn.classList.add("correct");
          feedbackEl.textContent = "âœ… å¾ˆå¥½ï¼ä½ è‡ªå·±åœ¨æ•°è½´ä¸Šæ‰¾åˆ°äº†æ­£ç¡®çš„ç­”æ¡ˆã€‚";
          feedbackEl.classList.add("ok");
          score += 10;
        } else {
          btn.classList.add("wrong");
          feedbackEl.textContent = `âŒ è¿™æ¬¡æ­£ç¡®ç­”æ¡ˆæ˜¯ ${answer}ï¼Œå¯ä»¥åœ¨æ•°è½´ä¸Šå†ä» ${a} ä¸€ä¸ªä¸ªå¾€åæ•°ã€‚`;
          feedbackEl.classList.add("bad");
        }
        scoreEl.textContent = score;
        nextBtn.disabled = false;
      }

      nextBtn.addEventListener("click", newQuestion);
      restartBtn.addEventListener("click", () => {
        score = 0;
        scoreEl.textContent = score;
        newQuestion();
      });

      buildAnswerButtons();
      newQuestion();
    })();

    /* ---------- ç©æ³•äºŒï¼šæ‹†åå°å·¥åŠ ---------- */
    (function() {
      const scoreEl = document.getElementById("m2-score");
      const promptEl = document.getElementById("m2-prompt");
      const leftEl = document.getElementById("m2-left");
      const rightEl = document.getElementById("m2-right");
      const optionsEl = document.getElementById("m2-options");
      const feedbackEl = document.getElementById("m2-feedback");
      const nextBtn = document.getElementById("m2-next");
      const restartBtn = document.getElementById("m2-restart");

      let a = 9, b = 6, answer = 15;
      let score = 0;
      let answered = false;

      function renderPiles() {
        leftEl.innerHTML = "";
        rightEl.innerHTML = "";
        const icon = "ğŸŸ©";
        for (let i = 0; i < a; i++) {
          const span = document.createElement("span");
          span.textContent = icon;
          leftEl.appendChild(span);
        }
        for (let i = 0; i < b; i++) {
          const span = document.createElement("span");
          span.textContent = icon;
          rightEl.appendChild(span);
        }
      }

      function buildOptions() {
        optionsEl.innerHTML = "";
        const correctText = `${a} + ${b} = 10 + ${a + b - 10} = ${a + b}`;
        const wrong1 = `${a} + ${b} = ${a} + ${b}`;
        const wrong2 = `${a} + ${b} = ${b} + ${a}`;
        const wrong3 = `å…ˆç®— ${a - 1} + ${b + 1}`;

        const arr = shuffle([
          {text: correctText, correct:true},
          {text: wrong1, correct:false},
          {text: wrong2, correct:false},
          {text: wrong3, correct:false}
        ]);

        arr.forEach(opt => {
          const btn = document.createElement("button");
          btn.className = "num-btn";
          btn.style.fontSize = "12px";
          btn.style.whiteSpace = "normal";
          btn.textContent = opt.text;
          btn.addEventListener("click", () => handleOption(opt.correct, btn));
          optionsEl.appendChild(btn);
        });
      }

      function newQuestion() {
        answered = false;
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";
        nextBtn.disabled = true;

        // ç”Ÿæˆå…¸å‹â€œå‡‘åâ€é¢˜ï¼š9+2~9+6 æˆ– 8+3~8+7
        if (Math.random() < 0.5) {
          a = 9;
          b = Math.floor(Math.random() * 5) + 2; // 2~6
        } else {
          a = 8;
          b = Math.floor(Math.random() * 5) + 3; // 3~7
          if (a + b > 18) b = 3;
        }
        answer = a + b;

        promptEl.textContent = `é¢˜ç›®ï¼š${a} + ${b}`;
        renderPiles();
        buildOptions();
      }

      function handleOption(isCorrect, btn) {
        if (answered) return;
        answered = true;
        optionsEl.querySelectorAll(".num-btn").forEach(b => b.disabled = true);

        if (isCorrect) {
          btn.classList.add("correct");
          feedbackEl.textContent = "âœ… å¤ªæ£’äº†ï¼ä½ ä¼šç”¨â€œå…ˆå‡‘åâ€çš„æ–¹æ³•æ¥ç®—å•¦ã€‚";
          feedbackEl.classList.add("ok");
          score += 10;
        } else {
          btn.classList.add("wrong");
          feedbackEl.textContent = "âŒ æƒ³ä¸€æƒ³ï¼šæŠŠä¸Šé¢é‚£ä¸€å †å…ˆå‡‘æˆ 10ï¼Œä¼šå†™æˆ 10 + ï¼Ÿ";
          feedbackEl.classList.add("bad");
        }
        scoreEl.textContent = score;
        nextBtn.disabled = false;
      }

      nextBtn.addEventListener("click", newQuestion);
      restartBtn.addEventListener("click", () => {
        score = 0;
        scoreEl.textContent = score;
        newQuestion();
      });

      newQuestion();
    })();

    /* ---------- ç©æ³•ä¸‰ï¼šç™¾æ•°è¡¨å¯»å® ---------- */
    (function() {
      const scoreEl = document.getElementById("m3-score");
      const gridEl = document.getElementById("m3-grid");
      const feedbackEl = document.getElementById("m3-feedback");
      const promptEl = document.getElementById("m3-prompt");
      const nextBtn = document.getElementById("m3-next");

      let target = 37;
      let score = 0;
      let locked = false;

      function buildGrid() {
        gridEl.innerHTML = "";
        for (let i = 1; i <= 100; i++) {
          const cell = document.createElement("div");
          cell.className = "hundred-cell";
          cell.textContent = i;
          cell.addEventListener("click", () => handleClick(i, cell));
          gridEl.appendChild(cell);
        }
      }

      function newQuestion() {
        locked = false;
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";
        target = Math.floor(Math.random() * 100) + 1;
        promptEl.textContent = `è¯·åœ¨ä¸‹é¢çš„ç™¾æ•°è¡¨ä¸­æ‰¾åˆ° ${target}ï¼Œç‚¹å‡»å®ƒã€‚`;
        gridEl.querySelectorAll(".hundred-cell").forEach(c => {
          c.classList.remove("correct","wrong");
        });
      }

      function handleClick(num, cell) {
        if (locked) return;
        locked = true;
        if (num === target) {
          cell.classList.add("correct");
          feedbackEl.textContent = `âœ… æ‰¾å¯¹äº†ï¼è¿™ä¸ªæ ¼å­å°±æ˜¯ ${target}ã€‚`;
          feedbackEl.classList.add("ok");
          score += 10;
        } else {
          cell.classList.add("wrong");
          feedbackEl.textContent = `âŒ è¿™ä¸æ˜¯ ${target}ï¼Œå¯ä»¥çœ‹çœ‹å®ƒåœ¨ç¬¬å‡ è¡Œç¬¬å‡ åˆ—ï¼Œå†æ‰¾ä¸€æ‰¾ã€‚`;
          feedbackEl.classList.add("bad");
        }
        scoreEl.textContent = score;
      }

      nextBtn.addEventListener("click", () => {
        newQuestion();
      });

      buildGrid();
      newQuestion();
    })();

    /* ---------- ç©æ³•å››ï¼šå°å•†åº—ä¹°ä¸œè¥¿ ---------- */
    (function() {
      const scoreEl = document.getElementById("m4-score");
      const promptEl = document.getElementById("m4-prompt");
      const itemsEl = document.getElementById("m4-items");
      const optionsEl = document.getElementById("m4-options");
      const feedbackEl = document.getElementById("m4-feedback");
      const nextBtn = document.getElementById("m4-next");
      const restartBtn = document.getElementById("m4-restart");

      const items = [
        { name:"ç©å…·è½¦", price:32 },
        { name:"æœºå™¨äºº", price:45 },
        { name:"å°ç†Š", price:28 },
        { name:"æ‹¼å›¾", price:19 },
        { name:"è¶³çƒ", price:36 }
      ];
      let money = 50;
      let chosen = null;
      let correctAnswer = 0;
      let score = 0;
      let answered = false;

      function renderItems() {
        itemsEl.innerHTML = "";
        items.forEach(it => {
          const card = document.createElement("div");
          card.className = "item-card";
          card.innerHTML = `
            <div class="item-name">${it.name}</div>
            <div class="item-price">ä»·æ ¼ï¼š${it.price} å…ƒ</div>
          `;
          itemsEl.appendChild(card);
        });
      }

      function newQuestion() {
        answered = false;
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";
        nextBtn.disabled = true;

        renderItems();
        money = Math.random() < 0.5 ? 50 : 100;
        chosen = items[Math.floor(Math.random()*items.length)];
        correctAnswer = money - chosen.price;

        promptEl.textContent =
          `ä½ æœ‰ ${money} å…ƒï¼Œä¹°ä¸€ä¸ª ${chosen.price} å…ƒçš„ã€${chosen.name}ã€‘ï¼Œè¿˜å‰©å¤šå°‘é’±ï¼Ÿ`;

        buildOptions();
      }

      function buildOptions() {
        optionsEl.innerHTML = "";
        const opts = [correctAnswer];
        let d1 = correctAnswer + (Math.random()<0.5 ? -2 : 2);
        let d2 = correctAnswer + (Math.random()<0.5 ? -5 : 5);
        if (d1 < 0) d1 = correctAnswer + 3;
        if (d2 < 0) d2 = correctAnswer + 4;
        opts.push(d1, d2);
        const unique = [...new Set(opts)];
        const arr = shuffle(unique);

        arr.forEach(val => {
          const btn = document.createElement("button");
          btn.className = "num-btn";
          btn.textContent = val + " å…ƒ";
          btn.addEventListener("click", () => handleAnswer(val, btn));
          optionsEl.appendChild(btn);
        });
      }

      function handleAnswer(val, btn) {
        if (answered) return;
        answered = true;
        optionsEl.querySelectorAll(".num-btn").forEach(b => b.disabled = true);

        if (val === correctAnswer) {
          btn.classList.add("correct");
          feedbackEl.textContent = "âœ… å¾ˆæ£’ï¼ä½ ç®—å¯¹äº†æ‰¾å›æ¥çš„é’±ã€‚";
          feedbackEl.classList.add("ok");
          score += 10;
        } else {
          btn.classList.add("wrong");
          feedbackEl.textContent =
            `âŒ æ­£ç¡®ç»“æœæ˜¯ ${money} âˆ’ ${chosen.price} = ${correctAnswer}ï¼ˆå…ƒï¼‰ã€‚`;
          feedbackEl.classList.add("bad");
        }
        scoreEl.textContent = score;
        nextBtn.disabled = false;
      }

      nextBtn.addEventListener("click", newQuestion);
      restartBtn.addEventListener("click", () => {
        score = 0;
        scoreEl.textContent = score;
        newQuestion();
      });

      newQuestion();
    })();

    /* ---------- ç©æ³•äº”ï¼šä¹˜æ³•é˜µåˆ—å†œåœºï¼ˆä¸¤æ­¥ï¼‰ ---------- */
    (function() {
      const scoreEl = document.getElementById("m5-score");
      const promptEl = document.getElementById("m5-prompt");
      const arrayEl = document.getElementById("m5-array");
      const expOptionsEl = document.getElementById("m5-exp-options");
      const numOptionsEl = document.getElementById("m5-num-options");
      const step1LabelEl = document.getElementById("m5-step1-label");
      const step2LabelEl = document.getElementById("m5-step2-label");
      const feedbackEl = document.getElementById("m5-feedback");
      const nextBtn = document.getElementById("m5-next");
      const restartBtn = document.getElementById("m5-restart");

      const icons = ["ğŸ¤","ğŸ‘","ğŸ„","ğŸŒ½","ğŸ“"];
      let rows = 3, cols = 4, answer = 12;
      let score = 0;
      let expChosenCorrect = false;

      function renderArray() {
        arrayEl.innerHTML = "";
        const icon = icons[Math.floor(Math.random()*icons.length)];
        for (let r = 0; r < rows; r++) {
          const rowDiv = document.createElement("div");
          rowDiv.className = "array-row";
          for (let c = 0; c < cols; c++) {
            const cell = document.createElement("div");
            cell.className = "array-cell";
            cell.textContent = icon;
            rowDiv.appendChild(cell);
          }
          arrayEl.appendChild(rowDiv);
        }
      }

      function buildExpOptions() {
        expOptionsEl.innerHTML = "";
        numOptionsEl.innerHTML = "";
        step2LabelEl.style.display = "none";
        numOptionsEl.style.display = "none";
        expChosenCorrect = false;
        nextBtn.disabled = true;

        const correctExp = `${rows} Ã— ${cols}`;
        const wrong1 = `${cols} Ã— ${rows}`;
        const wrong2 = `${rows} + ${cols}`;
        const wrong3 = `${cols} + ${cols}`;

        const arr = shuffle([
          {text: correctExp, correct:true},
          {text: wrong1, correct:false},
          {text: wrong2, correct:false},
          {text: wrong3, correct:false}
        ]);

        arr.forEach(opt => {
          const btn = document.createElement("button");
          btn.className = "num-btn";
          btn.style.fontSize = "14px";
          btn.textContent = opt.text;
          btn.addEventListener("click", () => handleExpClick(opt, btn));
          expOptionsEl.appendChild(btn);
        });
      }

      function handleExpClick(opt, btn) {
        if (expChosenCorrect) return;

        expOptionsEl.querySelectorAll(".num-btn").forEach(b => b.disabled = true);

        if (opt.correct) {
          btn.classList.add("correct");
          feedbackEl.textContent =
            "âœ… è¡Œæ•°åœ¨å‰ï¼Œæ¯è¡Œæœ‰å‡ ä¸ªåœ¨åï¼Œæ‰€ä»¥å†™æˆâ€œè¡Œæ•° Ã— æ¯è¡Œä¸ªæ•°â€ã€‚";
          feedbackEl.className = "feedback ok";
          expChosenCorrect = true;
          step2LabelEl.style.display = "block";
          numOptionsEl.style.display = "grid";
          buildNumOptions();
        } else {
          btn.classList.add("wrong");
          feedbackEl.textContent =
            `âŒ å†æƒ³ä¸€æƒ³ï¼šé¢˜ç›®é‡Œå…ˆè¯´â€œ${rows} è¡Œâ€ï¼Œæ‰€ä»¥ç®—å¼å‰é¢çš„æ•°åº”è¯¥æ˜¯å‡ è¡Œï¼Ÿ`;
          feedbackEl.className = "feedback bad";

          setTimeout(() => {
            expOptionsEl.querySelectorAll(".num-btn").forEach(b => {
              b.disabled = false;
            });
          }, 400);
        }
      }

      function buildNumOptions() {
        numOptionsEl.innerHTML = "";
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";

        const correct = answer;
        const wrong1 = correct + (Math.random()<0.5 ? -2 : 2);
        const wrong2 = correct + (Math.random()<0.5 ? -4 : 4);
        const arr = shuffle([correct, wrong1, wrong2]);

        arr.forEach(val => {
          const btn = document.createElement("button");
          btn.className = "num-btn";
          btn.textContent = val;
          btn.addEventListener("click", () => handleNumClick(val, btn));
          numOptionsEl.appendChild(btn);
        });
      }

      function handleNumClick(val, btn) {
        numOptionsEl.querySelectorAll(".num-btn").forEach(b => b.disabled = true);

        if (val === answer) {
          btn.classList.add("correct");
          feedbackEl.textContent =
            `âœ… å¤ªæ£’äº†ï¼ä½ æ—¢å†™å¯¹äº† ${rows} Ã— ${cols}ï¼Œåˆç®—å‡ºäº†ç»“æœæ˜¯ ${answer}ã€‚`;
          feedbackEl.className = "feedback ok";
          score += 10;
        } else {
          btn.classList.add("wrong");
          feedbackEl.textContent =
            `âŒ å†æ•°ä¸€æ•°ï¼šä¸€å…±æœ‰ ${rows} è¡Œï¼Œæ¯è¡Œ ${cols} ä¸ªï¼Œå°±æ˜¯ ${rows}Ã—${cols}=${answer}ã€‚`;
          feedbackEl.className = "feedback bad";
        }
        scoreEl.textContent = score;
        nextBtn.disabled = false;
      }

      function newQuestion() {
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";

        rows = Math.floor(Math.random()*4) + 2; // 2~5
        cols = Math.floor(Math.random()*4) + 2; // 2~5
        answer = rows * cols;

        promptEl.textContent =
          `è¿™é‡Œæœ‰ ${rows} è¡Œï¼Œæ¯è¡Œ ${cols} ä¸ªå°åŠ¨ç‰©ï¼Œä¸€å…±æœ‰å¤šå°‘ä¸ªï¼Ÿ`;
        renderArray();
        buildExpOptions();
      }

      nextBtn.addEventListener("click", newQuestion);
      restartBtn.addEventListener("click", () => {
        score = 0;
        scoreEl.textContent = score;
        newQuestion();
      });

      newQuestion();
    })();

    /* ---------- ç©æ³•å…­ï¼šä¹˜æ³•å£è¯€é…å¯¹ ---------- */
    (function() {
      const gridEl = document.getElementById("m6-grid");
      const feedbackEl = document.getElementById("m6-feedback");
      const doneEl = document.getElementById("m6-done");
      const restartBtn = document.getElementById("m6-restart");

      const pairs = [
        {expr:"2Ã—3", value:6},
        {expr:"3Ã—4", value:12},
        {expr:"4Ã—5", value:20},
        {expr:"5Ã—3", value:15}
      ];

      let cards = [];
      let first = null;
      let doneCount = 0;

      function buildGrid() {
        gridEl.innerHTML = "";
        feedbackEl.textContent = "";
        feedbackEl.className = "feedback";
        doneCount = 0;
        doneEl.textContent = doneCount;
        first = null;

        cards = [];
        pairs.forEach((p, idx) => {
          cards.push({ id:"e"+idx, type:"expr", text:p.expr, pairIndex:idx });
          cards.push({ id:"v"+idx, type:"val", text:String(p.value), pairIndex:idx });
        });
        shuffle(cards);

        cards.forEach(c => {
          const div = document.createElement("div");
          div.className = "pair-card";
          div.textContent = c.text;
          div.dataset.id = c.id;
          div.dataset.type = c.type;
          div.dataset.pairIndex = c.pairIndex;
          div.addEventListener("click", () => handleClick(div));
          gridEl.appendChild(div);
        });
      }

      function handleClick(cardEl) {
        if (cardEl.classList.contains("matched")) return;
        if (first && first === cardEl) return;

        if (!first) {
          first = cardEl;
          cardEl.classList.add("active");
          feedbackEl.textContent = "";
          feedbackEl.className = "feedback";
        } else {
          const p1 = first.dataset.pairIndex;
          const p2 = cardEl.dataset.pairIndex;
          cardEl.classList.add("active");
          if (p1 === p2 && first.dataset.type !== cardEl.dataset.type) {
            first.classList.remove("active");
            cardEl.classList.remove("active");
            first.classList.add("matched");
            cardEl.classList.add("matched");
            doneCount++;
            doneEl.textContent = doneCount;
            feedbackEl.textContent = "âœ… é…å¯¹æˆåŠŸï¼";
            feedbackEl.classList.add("ok");
          } else {
            feedbackEl.textContent = "âŒ è¿™ä¸¤å¼ ä¸æ˜¯ä¸€å¯¹ï¼Œå†è¯•è¯•åˆ«çš„ç»„åˆã€‚";
            feedbackEl.classList.add("bad");
            const oldFirst = first;
            setTimeout(() => {
              oldFirst.classList.remove("active");
              cardEl.classList.remove("active");
            }, 400);
          }
          first = null;
        }
      }

      restartBtn.addEventListener("click", buildGrid);
      buildGrid();
    })();
  </script>
</body>
</html>
